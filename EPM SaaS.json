{
  "name": "EPM SaaS",
  "version": "1",
  "items": [
    {
      "type": "http",
      "name": "Add app to app group",
      "seq": 7,
      "request": {
        "url": "{{EPM_SERVER}}/EPM/API/{{VERSION}}/Sets/{{SET_ID}}/Policies/ApplicationGroups/{{APP_GROUP_ID}}",
        "method": "PUT",
        "headers": [
          {
            "name": "Authorization",
            "value": "basic {{TOKEN}}",
            "enabled": true
          }
        ],
        "params": [],
        "body": {
          "mode": "json",
          "json": "{\n  \"Applications\": [\n    {\n      \"id\": \"00000000-0000-0000-0000-000000000001\",\n      \"internalId\": 0,\n      \"internalIndex\": 0,\n      \"applicationType\": 3,\n      \"displayName\": \"acrobat.exe\",\n      \"description\": \"\",\n      \"patterns\": {\n        \"FILE_NAME\": {\n          \"@type\": \"FileName\",\n          \"content\": \"acrobat.exe\",\n          \"compareAs\": 0,\n          \"caseSensitive\": true,\n          \"onlyEmptyValue\": false,\n          \"isEmpty\": false,\n          \"hashAlgorithm\": \"\",\n          \"hash\": \"\",\n          \"fileSize\": 0\n        },\n        \"ARGUMENTS\": {\n          \"@type\": \"Text\",\n          \"content\": \"\",\n          \"compareAs\": 0,\n          \"caseSensitive\": true,\n          \"onlyEmptyValue\": false,\n          \"isEmpty\": true\n        },\n        \"LOCATION\": {\n          \"@type\": \"Location\",\n          \"content\": \"\",\n          \"withSubfolders\": true,\n          \"caseSensitive\": true,\n          \"isEmpty\": true\n        },\n        \"PUBLISHER\": {\n          \"@type\": \"Publisher\",\n          \"content\": \"Adobe, Inc.\",\n          \"compareAs\": 0,\n          \"caseSensitive\": false,\n          \"onlyEmptyValue\": false,\n          \"isEmpty\": true,\n          \"signatureLevel\": 2,\n          \"separator\": \";\"\n        }\n      },\n      \"applicationGroupId\": \"{{APP_GROUP_ID}}\",\n      \"internalApplicationGroupId\": 0,\n      \"includeInMatching\": true,\n      \"softwareDistributorName\": null,\n      \"accountId\": \"00000000-0000-0000-0000-000000000000\",\n      \"childProcess\": false,\n      \"LinuxChildProcess\": 2,\n      \"restrictOpenSaveFileDialog\": false,\n      \"securityTokenId\": \"00000000-0000-0000-0000-000000000000\",\n      \"protectInstalledFiles\": false,\n      \"securityLevel\": \"LOW\"\n    }\n  ],\n  \"PolicyType\": 14,\n  \"Name\": \"3.1 - QuickStart - IT Pre-approved modern applications\",\n  \"Description\": \"Pre-approved modern applications for IT AD group.\"\n}",
          "formUrlEncoded": [],
          "multipartForm": []
        },
        "script": {},
        "vars": {},
        "assertions": [],
        "tests": "",
        "auth": {
          "mode": "none"
        }
      }
    },
    {
      "type": "http",
      "name": "Authenticate",
      "seq": 2,
      "request": {
        "url": "{{EPM_LOGIN}}/EPM/API/{{VERSION}}/Auth/EPM/Logon",
        "method": "POST",
        "headers": [],
        "params": [],
        "body": {
          "mode": "json",
          "json": "{\n  \"Username\": \"{{USERNAME}}\",\n  \"Password\": \"{{PASSWORD}}\",\n  \"ApplicationID\": \"bruno\"\n}",
          "formUrlEncoded": [],
          "multipartForm": []
        },
        "script": {},
        "vars": {},
        "assertions": [],
        "tests": "",
        "auth": {
          "mode": "none"
        }
      }
    },
    {
      "type": "http",
      "name": "Get aggregated elevation requests",
      "seq": 5,
      "request": {
        "url": "{{EPM_SERVER}}/EPM/API/{{VERSION}}/Sets/{{SET_ID}}/events/aggregations/search",
        "method": "POST",
        "headers": [
          {
            "name": "Authorization",
            "value": "basic {{TOKEN}}",
            "enabled": true
          }
        ],
        "params": [],
        "body": {
          "mode": "json",
          "json": "{\n  \"filter\": \"eventType IN ElevationRequest\"\n}",
          "formUrlEncoded": [],
          "multipartForm": []
        },
        "script": {},
        "vars": {},
        "assertions": [],
        "tests": "",
        "auth": {
          "mode": "none"
        }
      }
    },
    {
      "type": "http",
      "name": "Get application group",
      "seq": 6,
      "request": {
        "url": "{{EPM_SERVER}}/EPM/API/{{VERSION}}/Sets/{{SET_ID}}/Policies/ApplicationGroups/Search?limit=100&offset=0&sortBy=PolicyName&sortDir=desc",
        "method": "POST",
        "headers": [
          {
            "name": "Authorization",
            "value": "basic {{TOKEN}}",
            "enabled": true
          }
        ],
        "params": [
          {
            "name": "limit",
            "value": "100",
            "type": "query",
            "enabled": true
          },
          {
            "name": "offset",
            "value": "0",
            "type": "query",
            "enabled": true
          },
          {
            "name": "sortBy",
            "value": "PolicyName",
            "type": "query",
            "enabled": true
          },
          {
            "name": "sortDir",
            "value": "desc",
            "type": "query",
            "enabled": true
          }
        ],
        "body": {
          "mode": "none",
          "formUrlEncoded": [],
          "multipartForm": []
        },
        "script": {},
        "vars": {},
        "assertions": [],
        "tests": "",
        "auth": {
          "mode": "none"
        }
      }
    },
    {
      "type": "http",
      "name": "Get policies",
      "seq": 4,
      "request": {
        "url": "{{EPM_SERVER}}/EPM/API/{{VERSION}}/Sets/{{SET_ID}}/Policies/Server/Search?limit=100&offset=0&sortBy=PolicyName&sortDir=desc",
        "method": "POST",
        "headers": [
          {
            "name": "Authorization",
            "value": "basic {{TOKEN}}",
            "enabled": true
          },
          {
            "name": "Content-Type",
            "value": "application/json",
            "enabled": true
          }
        ],
        "params": [
          {
            "name": "limit",
            "value": "100",
            "type": "query",
            "enabled": true
          },
          {
            "name": "offset",
            "value": "0",
            "type": "query",
            "enabled": true
          },
          {
            "name": "sortBy",
            "value": "PolicyName",
            "type": "query",
            "enabled": true
          },
          {
            "name": "sortDir",
            "value": "desc",
            "type": "query",
            "enabled": true
          }
        ],
        "body": {
          "mode": "json",
          "json": "{\n  \"filter\": \"PolicyType EQ ADV_WIN\"\n}",
          "formUrlEncoded": [],
          "multipartForm": []
        },
        "script": {},
        "vars": {},
        "assertions": [],
        "tests": "",
        "auth": {
          "mode": "none"
        }
      }
    },
    {
      "type": "http",
      "name": "Get sets",
      "seq": 3,
      "request": {
        "url": "{{EPM_SERVER}}/EPM/API/{{VERSION}}/Sets",
        "method": "GET",
        "headers": [
          {
            "name": "Authorization",
            "value": "basic {{TOKEN}}",
            "enabled": true
          }
        ],
        "params": [],
        "body": {
          "mode": "none",
          "json": "{\n\"filter\": \"\"\n}",
          "formUrlEncoded": [],
          "multipartForm": []
        },
        "script": {},
        "vars": {},
        "assertions": [],
        "tests": "",
        "auth": {
          "mode": "none"
        }
      }
    },
    {
      "type": "http",
      "name": "Get aggregated trust requests",
      "seq": 8,
      "request": {
        "url": "{{EPM_SERVER}}/EPM/API/{{VERSION}}/Sets/{{SET_ID}}/events/aggregations/search",
        "method": "POST",
        "headers": [
          {
            "name": "Authorization",
            "value": "basic {{TOKEN}}",
            "enabled": true
          }
        ],
        "params": [],
        "body": {
          "mode": "json",
          "json": "{\n  \"filter\": \"eventType IN ElevationRequest\"\n}",
          "formUrlEncoded": [],
          "multipartForm": []
        },
        "script": {},
        "vars": {},
        "assertions": [],
        "tests": "",
        "auth": {
          "mode": "none"
        }
      }
    }
  ],
  "environments": [
    {
      "variables": [
        {
          "name": "EPM_SERVER",
          "value": "",
          "enabled": true,
          "secret": false,
          "type": "text"
        },
        {
          "name": "EPM_LOGIN",
          "value": "https://login.epm.cyberark.com",
          "enabled": true,
          "secret": false,
          "type": "text"
        },
        {
          "name": "VERSION",
          "value": "25.6.1.4811",
          "enabled": true,
          "secret": false,
          "type": "text"
        },
        {
          "name": "SET_ID",
          "value": "",
          "enabled": true,
          "secret": false,
          "type": "text"
        },
        {
          "name": "USERNAME",
          "value": "",
          "enabled": true,
          "secret": false,
          "type": "text"
        },
        {
          "name": "APP_GROUP_ID",
          "value": "",
          "enabled": true,
          "secret": false,
          "type": "text"
        },
        {
          "name": "POLICY_ID",
          "value": "",
          "enabled": true,
          "secret": false,
          "type": "text"
        },
        {
          "name": "PASSWORD",
          "value": "",
          "enabled": true,
          "secret": true,
          "type": "text"
        },
        {
          "name": "TOKEN",
          "value": "",
          "enabled": true,
          "secret": true,
          "type": "text"
        }
      ],
      "name": "EPM SaaS"
    }
  ],
  "brunoConfig": {
    "version": "1",
    "name": "EPM SaaS",
    "type": "collection",
    "ignore": [
      "node_modules",
      ".git"
    ]
  }
}